-- Casting to varchar in this query is for integer fields that may be null - pandas promotes these to floats otherwise.

SELECT  /*+ LABEL ('airflow-skill-worldwinner_gsncom_daily_imports-t_sftp_responsys_ww_pet_summary')*/ CUSTOMER_ID,
    CASHGAMES_REG_DATE,
    FIRST_GAME_PLAYED_DATE,
    LAST_GAME_PLAYED_DATE,
    LAST_CASH_GAME_PLAYED_DATE,
    LAST_DEPOSIT_DATE,
    LAST_LOGIN_DATE,
    REAL_MONEY_DATE,
    TOTAL_BALANCE,
    GAME_CREDIT_BALANCE,
    CASH_BALANCE,
    RP_BALANCE,
    TOTAL_SIGNUPS,
    TOTAL_DEPOSITS,
    NET_DEPOSITS,
    TOTAL_ENTRY_FEES,
    CASH_ENTRY_FEES,
    PLAY_MONEY_ENTRY_FEES,
    PREMIER_LEVEL_PREVIOUS_MONTH,
    PREMIER_LEVEL_CURRENT_MONTH,
    PREMIER_CLUB_SIGNUP_DATE,
    ACCOUNT_STATE::varchar,
    BONUS_BUCKS_BALANCE,
    BONUS_BUCKS_ENTRY_FEES,
    BONUS_BUCKS_AWARDED,
    PREMIER_POINTS_PREVIOUS_MONTH,
    PREMIER_POINTS_CURRENT_MONTH,
    PREMIER_POINTS_NEXT_MONTH,
    PREMIER_LEVEL_NEXT_MONTH,
    P1_GAME
FROM airflow.snapshot_responsys_ww_pet_summary
where ds = '{{ ds }}'
EXCEPT
SELECT CUSTOMER_ID,
    CASHGAMES_REG_DATE,
    FIRST_GAME_PLAYED_DATE,
    LAST_GAME_PLAYED_DATE,
    LAST_CASH_GAME_PLAYED_DATE,
    LAST_DEPOSIT_DATE,
    LAST_LOGIN_DATE,
    REAL_MONEY_DATE,
    TOTAL_BALANCE,
    GAME_CREDIT_BALANCE,
    CASH_BALANCE,
    RP_BALANCE,
    TOTAL_SIGNUPS,
    TOTAL_DEPOSITS,
    NET_DEPOSITS,
    TOTAL_ENTRY_FEES,
    CASH_ENTRY_FEES,
    PLAY_MONEY_ENTRY_FEES,
    PREMIER_LEVEL_PREVIOUS_MONTH,
    PREMIER_LEVEL_CURRENT_MONTH,
    PREMIER_CLUB_SIGNUP_DATE,
    ACCOUNT_STATE::varchar,
    BONUS_BUCKS_BALANCE,
    BONUS_BUCKS_ENTRY_FEES,
    BONUS_BUCKS_AWARDED,
    PREMIER_POINTS_PREVIOUS_MONTH,
    PREMIER_POINTS_CURRENT_MONTH,
    PREMIER_POINTS_NEXT_MONTH,
    PREMIER_LEVEL_NEXT_MONTH,
    P1_GAME
FROM airflow.snapshot_responsys_ww_pet_summary
where ds = '{{ yesterday_ds }}'